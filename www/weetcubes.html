<!DOCTYPE html>
<html>
<head>
<title>Weetcubes</title>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>

.parsegraph_Surface {
    width: 100%;
    height: 100%;
}

body {
    font-family: sans-serif;
    margin: 0;
    padding: 0;
    background: #111;
    color: #eee;
}

body > div {
    text-align: center;
    position: absolute;
}

.Successful {
    color: green;
}

.Crashed {
    color: maroon;
}

.Failed {
    color: red;
}

@media only screen and (max-width: 980px) {

body > div {
    width: 100%;
}

body > div input {
    clear: left;
}

}
</style>
<script src="parsegraph-1.3.js"></script>
<script src="parsegraph-widgets-1.3.js"></script>
<script>

var inited = false;
document.addEventListener("click", function(event) {
if(inited) {
    return;
}
inited = true;

parsegraph_initialize();

var surface = new parsegraph_Surface();
surface.startAudio();
document.body.appendChild(surface.container());

var widget = new alpha_WeetCubeWidget(surface);
WIDGET = widget;

surface.addPainter(widget.paint, widget);
surface.addRenderer(widget.render, widget);

var start = alpha_GetTime();
var audioUpdate = null;
var frozen = true;
var tick = function(t) {
    // Set the render flag.
    var t = alpha_GetTime();
    var elapsed = t - start;
    var updateAudio = audioUpdate === null || (t - audioUpdate > .1);
    widget.Tick(elapsed, frozen, updateAudio);
    if(!frozen || !widget.cubePainter) {
        surface.paint();
    }
    else if(widget._modeSwitched) {
        surface.paint();
    }
    if(updateAudio) {
        audioUpdate = t;
    }
    if(!frozen) {
        start = t;
    }
    surface.render();

    // Reschedule.
    tickIntervalId = requestAnimationFrame(tick)
};
tickIntervalId = requestAnimationFrame(tick);

var backgroundAudioForcer = new parsegraph_IntervalTimer();
backgroundAudioForcer.setDelay(0);
backgroundAudioForcer.setListener(function() {
    // Set the render flag.
    var t = alpha_GetTime();
    var elapsed = t - start;
    var updateAudio = audioUpdate === null || (t - audioUpdate > .1);
    widget.Tick(elapsed, frozen, updateAudio);
    if(!frozen || !widget.cubePainter) {
        surface.paint(elapsed, frozen, updateAudio);
    }
    if(updateAudio) {
        audioUpdate = t;
    }
    start = t;
}, this);
backgroundAudioForcer.schedule();

parsegraph_addEventListener(document, "keydown", function(event) {
    if(event.key === "Escape") {
        frozen = !frozen;
    }
});

}); // DOMContentLoaded
</script>
</head>
<body>
